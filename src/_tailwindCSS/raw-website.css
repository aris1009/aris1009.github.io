@import "../_css/base.css";
@import "../_css/components/header.css";
@import "../_css/components/footer.css";
@import "../_css/components/article.css";
@import "../_css/components/dictionary.css";
@import "../_css/components/theme.css";
@import "../_css/components/language.css";
@import "../_css/utilities/layout.css";
@import "../_css/utilities/typography.css";

@media (min-width: 450px) {
  html {
    @apply px-6 text-lg;
  }
  header {
    @apply py-5 px-3;
  }
  main,
  article {
    @apply py-4 px-3;
  }
  footer {
    @apply py-7 px-3;
  }
  .burger-title {
    @apply text-3xl;
  }
  .elenco-posts {
    @apply gap-6;
  }
}

@media (min-width: 768px) {
  html {
    @apply px-7 text-xl;
  }
  header {
    @apply py-6 px-4;
  }
  main,
  article {
    @apply py-4 px-4;
  }
  footer {
    @apply py-8 px-4;
  }
  .burger-menu-content {
    @apply w-96;
  }
  .burger-title {
    @apply text-4xl;
  }
  h1,
  article > small.info {
    @apply text-left;
  }
  .elenco-posts {
    @apply gap-7;
  }
  footer {
    @apply flex-row items-center justify-between;
  }
  .credit {
    @apply grow-0 text-center;
  }
  .links {
    @apply absolute left-1/2 transform -translate-x-1/2;
  }
  .social {
    @apply grow-0 gap-7 justify-end;
  }
}

@media (min-width: 1280px) {
  html {
    @apply px-8 text-xl;
  }
  header {
    @apply py-9 px-4;
  }
  main,
  article {
    @apply py-4 px-4 max-w-screen-md;
  }
  footer {
    @apply py-9 px-4;
  }
  .social {
    @apply grow-0 gap-8 justify-end;
  }
}

@media (min-width: 1600px) {
  html {
    @apply px-9 text-xl;
  }
  header {
    @apply py-10 px-5;
  }
  main,
  article {
    @apply py-4 px-5 max-w-screen-lg;
  }
  footer {
    @apply py-10 px-5;
  }
  .social {
    @apply grow-0 gap-9 justify-end;
  }
}

/* Link Component Styles */
@layer components {
  /* Common link styles */
  .external-link,
  .internal-link,
  .dictionary-link {
    @apply inline-flex items-center gap-1 transition-colors duration-200;
  }

  .external-link:hover,
  .internal-link:hover {
    @apply text-blue-600 dark:text-blue-400;
  }

  .dictionary-link {
    @apply cursor-pointer bg-transparent border-none p-0 text-blue-600 dark:text-blue-400 underline underline-offset-2;
  }

  .dictionary-link:hover {
    @apply text-blue-800 dark:text-blue-300;
  }

  /* Emoji indicators */
  .emoji-indicator {
    @apply text-xs opacity-70 ml-0.5;
    font-size: 0.75em;
    vertical-align: super;
  }

  .external-emoji {
    @apply text-green-600 dark:text-green-400;
  }

  .internal-emoji {
    @apply text-blue-600 dark:text-blue-400;
  }

  .dictionary-emoji {
    @apply text-purple-600 dark:text-purple-400;
  }

  /* Shoelace Dictionary Tooltip Styling */
  sl-tooltip[data-testid^="dictionary-tooltip"] {
    /* Light mode tooltip styling */
    --sl-tooltip-background-color: #f8f9fa;
    --sl-tooltip-color: #1f2937;
    --sl-tooltip-border-color: #e5e7eb;
    --sl-tooltip-border-width: 1px;
    --sl-tooltip-border-radius: 8px;
    --sl-tooltip-padding: 12px;
    --sl-tooltip-arrow-size: 6px;
    --sl-tooltip-font-size: 14px;
    --sl-tooltip-font-weight: 400;
    --sl-tooltip-line-height: 1.5;
    --sl-tooltip-max-width: 280px;
    --sl-tooltip-z-index: 9999;
  }

  /* Dark mode tooltip styling */
  html.dark sl-tooltip[data-testid^="dictionary-tooltip"],
  html.sl-theme-dark sl-tooltip[data-testid^="dictionary-tooltip"] {
    --sl-tooltip-background-color: #374151;
    --sl-tooltip-color: #f9fafb;
    --sl-tooltip-border-color: #4b5563;
    --sl-tooltip-border-width: 1px;
  }

  /* Ensure shadow DOM parts respect high z-index */
  sl-tooltip[data-testid^="dictionary-tooltip"]::part(popup) {
    z-index: 9999 !important;
  }

  sl-tooltip[data-testid^="dictionary-tooltip"]::part(base) {
    z-index: 9999 !important;
  }

  /* Dictionary Tooltip Content Styling */
  .dictionary-tooltip-content {
    @apply p-0;
  }

  .dictionary-tooltip-content .tooltip-term {
    @apply text-lg font-semibold mb-2 text-blue-600 dark:text-blue-400;
  }

  .dictionary-tooltip-content .tooltip-definition {
    @apply text-sm text-gray-700 dark:text-gray-300 leading-relaxed;
  }

  /* Theme Toggle Shortcode Styles */
  .theme-toggle {
    @apply relative;
  }

  .theme-icon {
    @apply text-base transition-opacity duration-200;
  }

  .light-icon {
    @apply opacity-100 dark:opacity-0;
  }

  .dark-icon {
    @apply opacity-0 dark:opacity-100 absolute inset-0 flex items-center justify-center;
  }

  /* Reading Progress Bar Styles */
  .reading-progress-bar {
    @apply fixed top-0 left-0 w-full h-1 opacity-0 transition-all duration-300 ease-out pointer-events-none;
    /* Subtle base track so the bar is visible even at 0% */
    background: linear-gradient(90deg, rgba(220, 38, 38, 0.15) 0%, rgba(220, 38, 38, 0.05) 100%);
    transform: translateY(-100%);
    z-index: 60;
  }

  /* Dark/light base track */
  html.dark .reading-progress-bar {
    background: linear-gradient(90deg, rgba(239, 68, 68, 0.25) 0%, rgba(239, 68, 68, 0.10) 100%);
  }

  .reading-progress-bar.visible {
    @apply opacity-100;
    transform: translateY(0);
  }

  .reading-progress-fill {
    @apply h-full transition-all duration-150 ease-out;
    width: 0%;
    background: linear-gradient(90deg, #dc2626 0%, #b91c1c 50%, #991b1b 100%);
    box-shadow: 0 1px 1px rgba(220, 38, 38, 0.3);
  }

  /* Dark mode adjustments */
  html.dark .reading-progress-fill {
    background: linear-gradient(90deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
    box-shadow: 0 1px 1px rgba(239, 68, 68, 0.4);
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .reading-progress-bar {
      @apply transition-none;
    }
    
    .reading-progress-fill {
      @apply transition-none;
    }
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .reading-progress-fill {
      background: #dc2626;
      box-shadow: none;
    }
    
    html.dark .reading-progress-fill {
      background: #ef4444;
    }
  }
}

/* Image Optimization Styles */
@layer components {
  /* Base responsive image styles */
  img {
    @apply max-w-full h-auto;
  }

  /* Responsive image container */
  .image-container {
    @apply relative overflow-hidden my-6;
  }

  /* Hero image styling */
  .hero-image {
    @apply w-full rounded-lg shadow-lg;
  }

  /* Article image styling */
  .article-image {
    @apply w-full rounded-md shadow-md my-6;
  }

  /* Thumbnail styling */
  .thumbnail {
    @apply rounded-full object-cover;
  }

  /* Progressive loading with blur effect */
  .image-with-placeholder {
    @apply transition-all duration-300 ease-in-out;
  }

  .image-with-placeholder.loading {
    @apply blur-sm scale-105;
  }

  .image-with-placeholder.loaded {
    @apply blur-0 scale-100;
  }

  /* Lazy loading fade-in */
  img[loading="lazy"] {
    @apply opacity-0 transition-opacity duration-300;
  }

  img[loading="lazy"].loaded {
    @apply opacity-100;
  }

  /* Picture element wrapper */
  .picture-wrapper {
    @apply block;
  }

  /* Ensure proper aspect ratio preservation */
  .aspect-ratio-container {
    @apply relative w-full;
    aspect-ratio: attr(data-aspect-ratio);
  }

  /* Dark mode image adjustments */
  html.dark img {
    @apply brightness-95 contrast-125;
  }

  /* High image quality for retina displays */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    img {
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
    }
  }

  /* Print optimization */
  @media print {
    img {
      @apply max-w-xs mx-auto block;
      page-break-inside: avoid;
    }
    
    .hero-image,
    .article-image {
      @apply shadow-none border border-gray-300;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .image-with-placeholder,
    img[loading="lazy"] {
      @apply transition-none;
    }
  }

  /* Support for picture element in older browsers */
  .picture-fallback {
    @apply block w-full h-auto;
  }

  /* Gallery styles for multiple images */
  .image-gallery {
    @apply grid gap-4 my-8;
  }

  .image-grid-2 {
    @apply grid-cols-1 md:grid-cols-2;
  }

  .image-grid-3 {
    @apply grid-cols-1 md:grid-cols-2 lg:grid-cols-3;
  }

  .image-grid-4 {
    @apply grid-cols-1 md:grid-cols-2 lg:grid-cols-4;
  }

  .gallery-item {
    @apply relative overflow-hidden rounded-lg;
  }

  .gallery-item img {
    @apply w-full h-48 object-cover transition-transform duration-300 hover:scale-105;
  }

  /* Caption styling */
  .image-caption {
    @apply text-sm text-gray-600 dark:text-gray-400 mt-2 text-center italic;
  }

  /* Lightbox support for future enhancement */
  .lightbox-trigger {
    @apply cursor-pointer;
  }

  .lightbox-trigger:hover img {
    @apply brightness-90;
  }
}
